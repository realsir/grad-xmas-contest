<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GRAD XMAS CONTEST</title>

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400;600&display=swap">

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg-main: #ffffff;
      --accent: #22c55e;
      --accent-dark: #15803d;
      --accent-soft: #dcfce7;
      --accent-soft-2: #f0fdf4;
      --text-main: #052e16;
      --text-muted: #4b6b57;
      --card-border: #bbf7d0;
    }

    body {
      min-height: 100vh;
      font-family: "Pixelify Sans", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-main);
      color: var(--text-main);
      overflow-x: hidden;
    }

    .matrix-bg {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: -1;
      font-family: "Pixelify Sans", monospace;
      font-size: 13px;
      color: #16a34a22;
      white-space: pre;
      line-height: 1.1;
      padding: 8px;
      user-select: none;
    }

    #app {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .card {
      background: rgba(255, 255, 255, 0.94);
      border-radius: 16px;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.12);
      padding: 32px 28px 28px;
      max-width: 1000px;
      width: 100%;
      text-align: center;
      border: 1px solid #e1f5e9;
    }

    .title {
      font-size: 28px;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 15px;
      color: var(--text-muted);
      margin-bottom: 22px;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin-top: 16px;
    }

    .btn-block {
      max-width: 260px;
    }

    .btn-main {
      display: inline-block;
      padding: 10px 22px;
      border-radius: 8px;
      border: 3px solid #064e3b;
      background: linear-gradient(135deg, #10b981, #22c55e);
      color: #f9f9f9;
      font-weight: 600;
      cursor: pointer;
      font-size: 15px;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 0 0 3px #bbf7d0, 0 12px 0 #047857;
      transition: transform 0.1s ease-out, box-shadow 0.1s ease-out, background 0.1s ease-out;
    }

    .btn-main:hover {
      transform: translateY(-2px);
      box-shadow: 0 14px 0 #047857;
      background: linear-gradient(135deg, #16a34a, #22c55e);
    }

    .btn-main:active {
      transform: translateY(2px);
      box-shadow: 0 6px 0 #047857;
    }

    .btn-secondary {
      padding: 8px 18px;
      border-radius: 8px;
      border: 2px solid #14532d;
      background: var(--accent-soft-2);
      color: #14532d;
      font-size: 13px;
      cursor: pointer;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      transition: background 0.1s ease-out, transform 0.08s ease-out, box-shadow 0.1s ease-out;
      box-shadow: 0 0 0 2px #bbf7d0;
    }

    .btn-secondary:hover {
      background: var(--accent-soft);
      transform: translateY(-1px);
    }

    .btn-secondary:active {
      transform: translateY(1px);
    }

    .btn-desc {
      margin-top: 6px;
      font-size: 13px;
      color: var(--text-muted);
      line-height: 1.35;
    }

    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 18px;
      flex-wrap: wrap;
    }

    .top-left {
      text-align: left;
    }

    .top-right {
      font-size: 13px;
      color: var(--text-muted);
      text-align: right;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px;
      margin-top: 8px;
    }

    .gallery-item {
      background: var(--accent-soft-2);
      border-radius: 12px;
      padding: 10px;
      border: 2px solid var(--card-border);
      display: flex;
      flex-direction: column;
      gap: 6px;
      box-shadow: 0 0 0 2px #bbf7d055;
      cursor: pointer;
    }

    .gallery-thumb {
      width: 100%;
      aspect-ratio: 4 / 3;
      border-radius: 8px;
      overflow: hidden;
      border: 3px solid #065f46;
      box-shadow: 0 0 0 3px #bbf7d0;
      background: #e5e7eb;
    }

    .gallery-thumb img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      image-rendering: pixelated;
      transition: transform 0.15s ease-out;
    }

    .gallery-item:hover .gallery-thumb img {
      transform: scale(1.03);
    }

    .gallery-caption {
      font-size: 12px;
      color: #14532d;
      text-align: left;
    }

    .center-row {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }

    .contest-images {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 18px;
      margin-top: 10px;
    }

    .contest-card {
      background: var(--accent-soft-2);
      border-radius: 14px;
      padding: 12px;
      border: 2px solid var(--card-border);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 8px;
      transition: transform 0.1s ease-out, box-shadow 0.1s ease-out, border-color 0.1s ease-out;
      box-shadow: 0 0 0 3px #bbf7d055;
    }

    .contest-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 16px 0 #16a34a33;
      border-color: var(--accent);
    }

    .contest-thumb {
      width: 100%;
      aspect-ratio: 4 / 3;
      border-radius: 10px;
      overflow: hidden;
      border: 3px solid #065f46;
      box-shadow: 0 0 0 3px #bbf7d0;
      background: #e5e7eb;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .contest-thumb img {
      width: 100%;
      height: 100%;
      display: block;
      object-fit: contain;
      image-rendering: pixelated;
    }

    .contest-label {
      font-size: 12px;
      color: #14532d;
      text-align: center;
    }

    .contest-progress {
      margin-top: 6px;
      font-size: 13px;
      color: #14532d;
      text-align: left;
    }

    .winner-photo {
      margin-top: 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    .winner-image {
      max-width: min(520px, 90vw);
      max-height: 70vh;
      width: auto;
      height: auto;
      display: block;
      object-fit: contain;
      image-rendering: pixelated;
      background: #fafafa;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 20px 48px rgba(0, 0, 0, 0.12);
    }

    .winner-title {
      font-size: 20px;
      color: var(--text-main);
      letter-spacing: 1px;
      text-transform: uppercase;
      font-weight: 600;
    }

    .winner-note {
      font-size: 18px;
      color: var(--text-main);
      font-weight: 600;
      letter-spacing: 1px;
    }

    .lightbox {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.92);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 100;
      padding: 20px;
      cursor: zoom-out;
    }

    .lightbox.is-visible {
      display: flex;
    }

    .lightbox img {
      max-width: 95vw;
      max-height: 95vh;
      width: auto;
      height: auto;
      object-fit: contain;
      image-rendering: pixelated;
      box-shadow: none;
      border: none;
      border-radius: 0;
    }

    @media (max-width: 640px) {
      .card {
        padding: 22px 18px 20px;
      }
      .title {
        font-size: 22px;
      }
      .contest-images {
        grid-template-columns: 1fr;
      }
      .top-row {
        flex-direction: column;
        align-items: flex-start;
      }
      .top-right {
        text-align: left;
      }
      .winner-image {
        max-width: min(400px, 95vw);
        padding: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="matrix-bg" id="matrixBg"></div>

  <div id="app"></div>

  <div class="lightbox" id="lightbox"></div>

  <script>
    function fillMatrixBackground() {
      const el = document.getElementById("matrixBg");
      const cols = Math.ceil(window.innerWidth / 12);
      const rows = Math.ceil(window.innerHeight / 14);
      let text = "";
      const chars = [".", "/"];
      for (let r = 0; r < rows; r++) {
        let line = "";
        for (let c = 0; c < cols; c++) {
          line += chars[(r + c) % 2] + " ";
        }
        text += line + "\n";
      }
      el.textContent = text;
    }

    window.addEventListener("resize", fillMatrixBackground);
    fillMatrixBackground();

    const IMAGE_COUNT = 44;
    const images = Array.from({ length: IMAGE_COUNT }, (_, i) => ({
      id: i + 1,
      src: `${i + 1}.png`
    }));

    const app = document.getElementById("app");
    const lightbox = document.getElementById("lightbox");

    function openLightbox(src) {
      lightbox.innerHTML = `<img src="${src}" alt="">`;
      lightbox.classList.add("is-visible");
    }

    function closeLightbox() {
      lightbox.classList.remove("is-visible");
      lightbox.innerHTML = "";
    }

    lightbox.addEventListener("click", closeLightbox);
    
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && lightbox.classList.contains("is-visible")) {
        closeLightbox();
      }
    });

    function renderHome() {
      app.innerHTML = `
        <div class="card">
          <h1 class="title">./ GRAD XMAS </h1>
          <p class="subtitle">
            I'm created this cozy website specifically for fun. It will preserve the history and creativity of the Gradient community.
          </p>

          <div class="btn-row">
            <div class="btn-block">
              <button class="btn-main" data-action="open-gallery">./ Gallery</button>
              <p class="btn-desc"><br>
                Browse every New Year artwork created by the Grad community.
              </p>
            </div>
            <div class="btn-block">
              <button class="btn-main" data-action="open-contest">./ Contest</button>
              <p class="btn-desc"><br>
                You are the jury. Compare artworks in pairs and keep only the most unique and stunning one.
              </p>
            </div>
          </div>
        </div>
      `;
    }

    function renderGallery() {
      const itemsHtml = images
        .map(
          (img) => `
          <div class="gallery-item"
               data-action="open-full"
               data-src="${img.src}">
            <div class="gallery-thumb">
              <img src="${img.src}" alt="#${img.id}" loading="lazy">
            </div>
            <div class="gallery-caption">#${img.id}</div>
          </div>
        `
        )
        .join("");

      app.innerHTML = `
        <div class="card">
          <div class="top-row">
            <div class="top-left">
              <h2 class="title">Gallery</h2>
              <p class="subtitle">Click any artwork to view full size.</p>
            </div>
            <div class="top-right">
              Total artworks: <strong>${IMAGE_COUNT}</strong>
            </div>
          </div>

          <div class="gallery-grid">
            ${itemsHtml}
          </div>

          <div class="center-row" style="margin-top:24px;">
            <button class="btn-secondary" data-action="back-menu">./ MENU</button>
          </div>
        </div>
      `;
    }

    let contestState = null;

    function startContest() {
      const ids = images.map((x) => x.id);

      for (let i = ids.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [ids[i], ids[j]] = [ids[j], ids[i]];
      }

      contestState = {
        queue: ids.slice(),
        winners: [],
        currentPair: null,
        round: 1
      };

      nextPair();
      renderContest();
    }

    function nextPair() {
      const st = contestState;
      if (!st) return;

      if (st.queue.length < 2) {
        if (st.queue.length === 1) {
          st.winners.push(st.queue[0]);
        }
        if (st.winners.length === 1) {
          st.currentPair = null;
          return;
        }
        st.queue = st.winners.slice();
        st.winners = [];
        st.round++;
      }

      const a = st.queue.shift();
      const b = st.queue.shift();
      st.currentPair = [a, b];
    }

    function chooseWinner(selectedId) {
      const st = contestState;
      if (!st || !st.currentPair) return;
      st.winners.push(selectedId);
      nextPair();
      renderContest();
    }

    function renderContest() {
      const st = contestState;
      if (!st) return;

      if (!st.currentPair && st.winners.length === 1) {
        const winnerId = st.winners[0];
        const winnerSrc = `${winnerId}.png`;
        app.innerHTML = `
          <div class="card">
            <h2 class="title">Contest Winner</h2>
            <p class="subtitle">
              You stayed honest through every round and crowned a single legendary artwork.
            </p>

            <div class="winner-photo">
              <div class="winner-title">üèÜ CHAMPION üèÜ</div>
              <img class="winner-image" src="${winnerSrc}" alt="Winner #${winnerId}">
              <div class="winner-note">#${winnerId}</div>
            </div>

            <div class="btn-row" style="margin-top:32px;">
              <button class="btn-secondary" data-action="back-menu">./ MENU</button>
              <button class="btn-secondary" data-action="restart-contest">./ AGAIN</button>
            </div>
          </div>
        `;
        return;
      }

      const [aId, bId] = st.currentPair || [];
      const totalMatchesPlayed = st.winners.length;
      const estimatedTotalMatches = Math.ceil(Math.log2(IMAGE_COUNT)) * 2;
      const progressPercent = Math.min(
        100,
        Math.round((totalMatchesPlayed / estimatedTotalMatches) * 100)
      );

      app.innerHTML = `
        <div class="card">
          <div class="top-row">
            <div class="top-left">
              <h2 class="title">./ CONTEST</h2>
              <p class="subtitle">Two artworks enter. One artwork leaves. Pick with your heart.</p>
            </div>
            <div class="top-right">
              Round: <strong>${st.round}</strong><br>
              Progress: ${progressPercent}%
            </div>
          </div>

          <p class="contest-progress">
            Click the artwork that feels more unique, magical, and unforgettable.
          </p>

          <div class="contest-images">
            <div class="contest-card" data-action="choose" data-id="${aId}">
              <div class="contest-thumb">
                <img src="${aId}.png" alt="#${aId}">
              </div>
              <div class="contest-label">Option A ¬∑ #${aId}</div>
            </div>

            <div class="contest-card" data-action="choose" data-id="${bId}">
              <div class="contest-thumb">
                <img src="${bId}.png" alt="#${bId}">
              </div>
              <div class="contest-label">Option B ¬∑ #${bId}</div>
            </div>
          </div>

          <div class="center-row" style="margin-top:20px;">
            <button class="btn-secondary" data-action="back-menu">./ MENU</button>
          </div>
        </div>
      `;
    }

    document.addEventListener("click", (e) => {
      const el = e.target.closest("[data-action]");
      if (!el) return;
      const action = el.getAttribute("data-action");

      if (action === "open-gallery") {
        renderGallery();
      } else if (action === "back-menu") {
        renderHome();
      } else if (action === "open-contest") {
        startContest();
      } else if (action === "choose") {
        const id = parseInt(el.getAttribute("data-id"), 10);
        chooseWinner(id);
      } else if (action === "restart-contest") {
        startContest();
      } else if (action === "open-full") {
        const src = el.getAttribute("data-src");
        openLightbox(src);
      }
    });

    renderHome();
  </script>
</body>
</html>

